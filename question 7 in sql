CREATE TABLE appearances (
    chef_id INT PRIMARY KEY,
    total_appearances INT NOT NULL DEFAULT 0,
    FOREIGN KEY (chef_id) REFERENCES chefs(chef_id)
);

-- Create the chef_min_appearances table
CREATE TABLE chef_min_appearances (
    chef_id INT PRIMARY KEY,
    total_appearances INT,
    FOREIGN KEY (chef_id) REFERENCES chefs(chef_id)
);

-- Populate the chef_min_appearances table with chefs having 5 or more appearances less than the chef with the maximum appearances
INSERT INTO chef_min_appearances (chef_id, total_appearances)
SELECT chef_id, total_appearances
FROM appearances
WHERE total_appearances <= (
    SELECT MAX(total_appearances) - 5
    FROM appearances
);

